module.exports=[565636,390599,a=>{"use strict";let b,c=(a,b,c=!1)=>a.getUint16(b,c),d=(a,b,c=!1)=>a.getUint32(b,c),e={};e.onload=()=>b=e.naturalWidth>e.naturalHeight,e.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=",a.s(["default",0,({addFilter:a,utils:e})=>{let{Type:f,isFile:g}=e;return a("DID_LOAD_ITEM",(a,{query:e})=>new Promise((f,h)=>{let i=a.file;if(!g(i)||!/^image\/jpeg/.test(i.type)||!e("GET_ALLOW_IMAGE_EXIF_ORIENTATION")||!b)return f(a);new Promise((a,b)=>{let e=new FileReader;e.onload=function(b){let e=new DataView(b.target.result);if(65496!==c(e,0))return void a(-1);let f=e.byteLength,g=2;for(;g<f;){let b=c(e,g);if(g+=2,65505===b){if(0x45786966!==d(e,g+=2))break;let b=18761===c(e,g+=6);g+=d(e,g+4,b);let f=c(e,g,b);g+=2;for(let d=0;d<f;d++)if(274===c(e,g+12*d,b))return void a(c(e,g+12*d+8,b))}else if((65280&b)!=65280)break;else g+=c(e,g)}a(-1)},e.readAsArrayBuffer(i.slice(0,65536))}).then(b=>{a.setMetadata("exif",{orientation:b}),f(a)})})),{options:{allowImageExifOrientation:[!0,f.BOOLEAN]}}}],565636);let f=(a,b)=>i(a.x*b,a.y*b),g=(a,b)=>i(a.x+b.x,a.y+b.y),h=(a,b,c)=>{let d=Math.cos(b),e=Math.sin(b),f=i(a.x-c.x,a.y-c.y);return i(c.x+d*f.x-e*f.y,c.y+e*f.x+d*f.y)},i=(a=0,b=0)=>({x:a,y:b}),j=(a,b,c=1,d)=>"string"==typeof a?parseFloat(a)*c:"number"==typeof a?a*(d?b[d]:Math.min(b.width,b.height)):void 0,k=(a,b)=>Object.keys(b).forEach(c=>a.setAttribute(c,b[c])),l=(a,b)=>{let c=document.createElementNS("http://www.w3.org/2000/svg",a);return b&&k(c,b),c},m={contain:"xMidYMid meet",cover:"xMidYMid slice"},n={left:"start",center:"middle",right:"end"},o=a=>b=>l(a,{id:b.id}),p={image:a=>{let b=l("image",{id:a.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return b.onload=()=>{b.setAttribute("opacity",a.opacity||1)},b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a.src),b},rect:o("rect"),ellipse:o("ellipse"),text:o("text"),path:o("path"),line:a=>{let b=l("g",{id:a.id,"stroke-linecap":"round","stroke-linejoin":"round"}),c=l("line");b.appendChild(c);let d=l("path");b.appendChild(d);let e=l("path");return b.appendChild(e),b}},q={rect:a=>k(a,{...a.rect,...a.styles}),ellipse:a=>{let b=a.rect.x+.5*a.rect.width,c=a.rect.y+.5*a.rect.height,d=.5*a.rect.width,e=.5*a.rect.height;return k(a,{cx:b,cy:c,rx:d,ry:e,...a.styles})},image:(a,b)=>{k(a,{...a.rect,...a.styles,preserveAspectRatio:m[b.fit]||"none"})},text:(a,b,c,d)=>{let e=j(b.fontSize,c,d),f=b.fontFamily||"sans-serif",g=b.fontWeight||"normal",h=n[b.textAlign]||"start";k(a,{...a.rect,...a.styles,"stroke-width":0,"font-weight":g,"font-size":e,"font-family":f,"text-anchor":h}),a.text!==b.text&&(a.text=b.text,a.textContent=b.text.length?b.text:" ")},path:(a,b,c,d)=>{k(a,{...a.styles,fill:"none",d:b.points.map(a=>({x:j(a.x,c,d,"width"),y:j(a.y,c,d,"height")})).map((a,b)=>`${0===b?"M":"L"} ${a.x} ${a.y}`).join(" ")})},line:(a,b,c,d)=>{var e;let l;k(a,{...a.rect,...a.styles,fill:"none"});let m=a.childNodes[0],n=a.childNodes[1],o=a.childNodes[2],p=a.rect,q={x:a.rect.x+a.rect.width,y:a.rect.y+a.rect.height};if(k(m,{x1:p.x,y1:p.y,x2:q.x,y2:q.y}),!b.lineDecoration)return;n.style.display="none",o.style.display="none";let r=0===(l=Math.sqrt((e={x:q.x-p.x,y:q.y-p.y}).x*e.x+e.y*e.y))?{x:0,y:0}:i(e.x/l,e.y/l),s=j(.05,c,d);if(-1!==b.lineDecoration.indexOf("arrow-begin")){let a=g(p,f(r,s)),b=h(p,2,a),c=h(p,-2,a);k(n,{style:"display:block;",d:`M${b.x},${b.y} L${p.x},${p.y} L${c.x},${c.y}`})}if(-1!==b.lineDecoration.indexOf("arrow-end")){let a=g(q,f(r,-s)),b=h(q,2,a),c=h(q,-2,a);k(o,{style:"display:block;",d:`M${b.x},${b.y} L${q.x},${q.y} L${c.x},${c.y}`})}}},r=["x","y","left","top","right","bottom","width","height"],s=a=>{let[b,c]=a,d=c.points?{}:r.reduce((a,b)=>{let d;return a[b]="string"==typeof(d=c[b])&&/%/.test(d)?parseFloat(d)/100:d,a},{});return[b,{zIndex:0,...c,...d}]},t=(a,b)=>a[1].zIndex>b[1].zIndex?1:a[1].zIndex<b[1].zIndex?-1:0,u=(a,b)=>({x:a,y:b}),v=(a,b)=>u(a.x-b.x,a.y-b.y),w=(a,b)=>{let c,d;return Math.sqrt((c=v(a,b),d=v(a,b),c.x*d.x+c.y*d.y))},x=(a,b)=>{let c=1.5707963267948966-b,d=Math.sin(c),e=Math.cos(c),f=a/1;return u(f*Math.sin(b)*e,f*d*e)},y=(a,b,c,d)=>{let e,f,g,h,i,j,k,l=d.x>.5?1-d.x:d.x,m=d.y>.5?1-d.y:d.y,n=2*l*a.width,o=2*m*a.height,p=(e=b.width,f=b.height,g=x(e,c),h=x(f,c),i=u(b.x+Math.abs(g.x),b.y-Math.abs(g.y)),j=u(b.x+b.width+Math.abs(h.y),b.y+Math.abs(h.x)),k=u(b.x-Math.abs(h.y),b.y+b.height-Math.abs(h.x)),{width:w(i,j),height:w(i,k)});return Math.max(p.width/n,p.height/o)},z=(a,b)=>{let c=a.width,d=c*b;return d>a.height&&(c=(d=a.height)/b),{x:(a.width-c)*.5,y:(a.height-d)*.5,width:c,height:d}},A={type:"spring",stiffness:.5,damping:.45,mass:10},B=`<svg width="500" height="200" viewBox="0 0 500 200" preserveAspectRatio="none">
    <defs>
        <radialGradient id="gradient-__UID__" cx=".5" cy="1.25" r="1.15">
            <stop offset='50%' stop-color='#000000'/>
            <stop offset='56%' stop-color='#0a0a0a'/>
            <stop offset='63%' stop-color='#262626'/>
            <stop offset='69%' stop-color='#4f4f4f'/>
            <stop offset='75%' stop-color='#808080'/>
            <stop offset='81%' stop-color='#b1b1b1'/>
            <stop offset='88%' stop-color='#dadada'/>
            <stop offset='94%' stop-color='#f6f6f6'/>
            <stop offset='100%' stop-color='#ffffff'/>
        </radialGradient>
        <mask id="mask-__UID__">
            <rect x="0" y="0" width="500" height="200" fill="url(#gradient-__UID__)"></rect>
        </mask>
    </defs>
    <rect x="0" width="500" height="200" fill="currentColor" mask="url(#mask-__UID__)"></rect>
</svg>`,C=0,D=function(){self.onmessage=a=>{createImageBitmap(a.data.message.file).then(b=>{self.postMessage({id:a.data.id,message:b},[b])})}},E=function(){self.onmessage=a=>{let b=a.data.message.imageData,c=a.data.message.colorMatrix,d=b.data,e=d.length,f=c[0],g=c[1],h=c[2],i=c[3],j=c[4],k=c[5],l=c[6],m=c[7],n=c[8],o=c[9],p=c[10],q=c[11],r=c[12],s=c[13],t=c[14],u=c[15],v=c[16],w=c[17],x=c[18],y=c[19],z=0,A=0,B=0,C=0,D=0;for(;z<e;z+=4)A=d[z]/255,B=d[z+1]/255,C=d[z+2]/255,D=d[z+3]/255,d[z]=Math.max(0,Math.min((A*f+B*g+C*h+D*i+j)*255,255)),d[z+1]=Math.max(0,Math.min((A*k+B*l+C*m+D*n+o)*255,255)),d[z+2]=Math.max(0,Math.min((A*p+B*q+C*r+D*s+t)*255,255)),d[z+3]=Math.max(0,Math.min((A*u+B*v+C*w+D*x+y)*255,255));self.postMessage({id:a.data.id,message:b},[b.data.buffer])}},F={1:()=>[1,0,0,1,0,0],2:a=>[-1,0,0,1,a,0],3:(a,b)=>[-1,0,0,-1,a,b],4:(a,b)=>[1,0,0,-1,0,b],5:()=>[0,1,1,0,0,0],6:(a,b)=>[0,1,-1,0,b,0],7:(a,b)=>[0,-1,-1,0,b,a],8:a=>[0,-1,1,0,0,a]},G=a=>/^image/.test(a.type)&&!/svg/.test(a.type),H=(a,b)=>Math.floor(Math.sqrt(a/(b/4)));a.s(["default",0,a=>{let{addFilter:b,utils:c}=a,{Type:d,createRoute:e,isFile:f}=c,g=(a=>{let b=a.utils.createView({name:"image-preview-overlay",tag:"div",ignoreRect:!0,create:({root:a,props:b})=>{let c=B;if(document.querySelector("base")){let a=new URL(window.location.href.replace(window.location.hash,"")).href;c=c.replace(/url\(\#/g,"url("+a+"#")}C++,a.element.classList.add(`filepond--image-preview-overlay-${b.status}`),a.element.innerHTML=c.replace(/__UID__/g,C)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),c=a.utils.createView({name:"image-preview",tag:"div",ignoreRect:!0,mixins:{apis:["image","crop","markup","resize","dirty","background"],styles:["translateY","scaleX","scaleY","opacity"],animations:{scaleX:A,scaleY:A,translateY:A,opacity:{type:"tween",duration:400}}},create:({root:b,props:c})=>{b.ref.clip=b.appendChildView(b.createChildView(a.utils.createView({name:"image-clip",tag:"div",ignoreRect:!0,mixins:{apis:["crop","markup","resize","width","height","dirty","background"],styles:["width","height","opacity"],animations:{opacity:{type:"tween",duration:250}}},didWriteView:function({root:a,props:b}){b.background&&(a.element.style.backgroundColor=b.background)},create:({root:b,props:c})=>{b.ref.image=b.appendChildView(b.createChildView(a.utils.createView({name:"image-canvas-wrapper",tag:"div",ignoreRect:!0,mixins:{apis:["crop","width","height"],styles:["originX","originY","translateX","translateY","scaleX","scaleY","rotateZ"],animations:{originX:A,originY:A,scaleX:A,scaleY:A,translateX:A,translateY:A,rotateZ:A}},create:({root:b,props:c})=>{c.width=c.image.width,c.height=c.image.height,b.ref.bitmap=b.appendChildView(b.createChildView(a.utils.createView({name:"image-bitmap",ignoreRect:!0,mixins:{styles:["scaleX","scaleY"]},create:({root:a,props:b})=>{a.appendChild(b.image)}}),{image:c.image}))},write:({root:a,props:b})=>{let{flip:c}=b.crop,{bitmap:d}=a.ref;d.scaleX=c.horizontal?-1:1,d.scaleY=c.vertical?-1:1}}),Object.assign({},c))),b.ref.createMarkup=()=>{b.ref.markup||(b.ref.markup=b.appendChildView(b.createChildView(a.utils.createView({name:"image-preview-markup",tag:"svg",ignoreRect:!0,mixins:{apis:["width","height","crop","markup","resize","dirty"]},write:({root:a,props:b})=>{if(!b.dirty)return;let{crop:c,resize:d,markup:e}=b,f=b.width,g=b.height,h=c.width,i=c.height;if(d){let{size:a}=d,b=a&&a.width,c=a&&a.height,e=d.mode,f=d.upscale;b&&!c&&(c=b),c&&!b&&(b=c);let g=h<b&&i<c;if(!g||g&&f){let a=b/h,d=c/i;if("force"===e)h=b,i=c;else{let b;"cover"===e?b=Math.max(a,d):"contain"===e&&(b=Math.min(a,d)),h*=b,i*=b}}}let k={width:f,height:g};a.element.setAttribute("width",k.width),a.element.setAttribute("height",k.height);let l=Math.min(f/h,g/i);a.element.innerHTML="";let m=a.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");e.filter(m).map(s).sort(t).forEach(b=>{let c,d,e,f,g,h,[i,m]=b,n=p[i](m);"path"!==i&&(n.rect=((a,b,c=1)=>{let d=j(a.x,b,c,"width")||j(a.left,b,c,"width"),e=j(a.y,b,c,"height")||j(a.top,b,c,"height"),f=j(a.width,b,c,"width"),g=j(a.height,b,c,"height"),h=j(a.right,b,c,"width"),i=j(a.bottom,b,c,"height");return null==e&&(e=null!=g&&null!=i?b.height-g-i:i),null==d&&(d=null!=f&&null!=h?b.width-f-h:h),null==f&&(f=null!=d&&null!=h?b.width-d-h:0),null==g&&(g=null!=e&&null!=i?b.height-e-i:0),{x:d||0,y:e||0,width:f||0,height:g||0}})(m,k,l)),c=m.borderStyle||m.lineStyle||"solid",d=m.backgroundColor||m.fontColor||"transparent",e=m.borderColor||m.lineColor||"transparent",f=j(m.borderWidth||m.lineWidth,k,l),g=m.lineCap||"round",h=m.lineJoin||"round",n.styles={"stroke-linecap":g,"stroke-linejoin":h,"stroke-width":f||0,"stroke-dasharray":"string"==typeof c?"":c.map(a=>j(a,k,l)).join(","),stroke:e,fill:d,opacity:m.opacity||1},q[i](n,m,k,l),a.element.appendChild(n)})}}),Object.assign({},c))))},b.ref.destroyMarkup=()=>{b.ref.markup&&(b.removeChildView(b.ref.markup),b.ref.markup=null)};let d=b.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");null!==d&&("grid"===d?b.element.dataset.transparencyIndicator=d:b.element.dataset.transparencyIndicator="color")},write:({root:a,props:b,shouldOptimize:c})=>{let{crop:d,markup:e,resize:f,dirty:g,width:h,height:i}=b;a.ref.image.crop=d;let j={x:0,y:0,width:h,height:i,center:{x:.5*h,y:.5*i}},k={width:a.ref.image.width,height:a.ref.image.height},l={x:d.center.x*k.width,y:d.center.y*k.height},m={x:j.center.x-k.width*d.center.x,y:j.center.y-k.height*d.center.y},n=2*Math.PI+d.rotation%(2*Math.PI),o=d.aspectRatio||k.height/k.width,p=void 0===d.scaleToFit||d.scaleToFit,q=y(k,z(j,o),n,p?d.center:{x:.5,y:.5}),r=d.zoom*q;e&&e.length?(a.ref.createMarkup(),a.ref.markup.width=h,a.ref.markup.height=i,a.ref.markup.resize=f,a.ref.markup.dirty=g,a.ref.markup.markup=e,a.ref.markup.crop=((a,b={})=>{let{zoom:c,rotation:d,center:e,aspectRatio:f}=b;f||(f=a.height/a.width);let g=((a,b,c=1)=>{let d=a.height/a.width,e=1,f=d;f>b&&(e=(f=b)/d);let g=Math.max(1/e,b/f),h=a.width/(c*g*e);return{width:h,height:h*b}})(a,f,c),h={x:.5*g.width,y:.5*g.height},i={x:0,y:0,width:g.width,height:g.height,center:h},j=void 0===b.scaleToFit||b.scaleToFit,k=c*y(a,z(i,f),d,j?e:{x:.5,y:.5});return{widthFloat:g.width/k,heightFloat:g.height/k,width:Math.round(g.width/k),height:Math.round(g.height/k)}})(k,d)):a.ref.markup&&a.ref.destroyMarkup();let s=a.ref.image;if(c){s.originX=null,s.originY=null,s.translateX=null,s.translateY=null,s.rotateZ=null,s.scaleX=null,s.scaleY=null;return}s.originX=l.x,s.originY=l.y,s.translateX=m.x,s.translateY=m.y,s.rotateZ=n,s.scaleX=r,s.scaleY=r}}),{id:c.id,image:c.image,crop:c.crop,markup:c.markup,resize:c.resize,dirty:c.dirty,background:c.background}))},write:({root:a,props:b,shouldOptimize:c})=>{let{clip:d}=a.ref,{image:e,crop:f,markup:g,resize:h,dirty:i}=b;if(d.crop=f,d.markup=g,d.resize=h,d.dirty=i,d.opacity=+!c,c||a.rect.element.hidden)return;let j=e.height/e.width,k=f.aspectRatio||j,l=a.rect.inner.width,m=a.rect.inner.height,n=a.query("GET_IMAGE_PREVIEW_HEIGHT"),o=a.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),p=a.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),q=a.query("GET_PANEL_ASPECT_RATIO"),r=a.query("GET_ALLOW_MULTIPLE");q&&!r&&(n=l*q,k=q);let s=null!==n?n:Math.max(o,Math.min(l*k,p)),t=s/k;t>l&&(s=(t=l)*k),s>m&&(s=m,t=m/k),d.width=t,d.height=s}}),{createWorker:d}=a.utils,e=(a,b,c)=>new Promise(e=>{a.ref.imageData||(a.ref.imageData=c.getContext("2d").getImageData(0,0,c.width,c.height));let f=(a=>{let b;try{b=new ImageData(a.width,a.height)}catch(c){b=document.createElement("canvas").getContext("2d").createImageData(a.width,a.height)}return b.data.set(new Uint8ClampedArray(a.data)),b})(a.ref.imageData);if(!b||20!==b.length)return c.getContext("2d").putImageData(f,0,0),e();let g=d(E);g.post({imageData:f,colorMatrix:b},a=>{c.getContext("2d").putImageData(a,0,0),g.terminate(),e()},[f.data.buffer])}),f=({root:a,props:b,image:d})=>{let e,f,g=b.id,h=a.query("GET_ITEM",{id:g});if(!h)return;let i=h.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},j=a.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),k=!1;a.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(e=h.getMetadata("markup")||[],f=h.getMetadata("resize"),k=!0);let l=a.appendChildView(a.createChildView(c,{id:g,image:d,crop:i,resize:f,markup:e,dirty:k,background:j,opacity:0,scaleX:1.15,scaleY:1.15,translateY:15}),a.childViews.length);a.ref.images.push(l),l.opacity=1,l.scaleX=1,l.scaleY=1,l.translateY=0,setTimeout(()=>{a.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:g})},250)},g=({root:a})=>{a.ref.overlayShadow.opacity=1,a.ref.overlayError.opacity=0,a.ref.overlaySuccess.opacity=0},h=({root:a})=>{a.ref.overlayShadow.opacity=.25,a.ref.overlayError.opacity=1};return a.utils.createView({name:"image-preview-wrapper",create:({root:a})=>{a.ref.images=[],a.ref.imageData=null,a.ref.imageViewBin=[],a.ref.overlayShadow=a.appendChildView(a.createChildView(b,{opacity:0,status:"idle"})),a.ref.overlaySuccess=a.appendChildView(a.createChildView(b,{opacity:0,status:"success"})),a.ref.overlayError=a.appendChildView(a.createChildView(b,{opacity:0,status:"failure"}))},styles:["height"],apis:["height"],destroy:({root:a})=>{a.ref.images.forEach(a=>{a.image.width=1,a.image.height=1})},didWriteView:({root:a})=>{a.ref.images.forEach(a=>{a.dirty=!1})},write:a.utils.createRoute({DID_IMAGE_PREVIEW_DRAW:({root:a})=>{let b=a.ref.images[a.ref.images.length-1];b.translateY=0,b.scaleX=1,b.scaleY=1,b.opacity=1},DID_IMAGE_PREVIEW_CONTAINER_CREATE:({root:a,props:b})=>{var c;let d,{id:e}=b,f=a.query("GET_ITEM",e);f&&(c=URL.createObjectURL(f.file),(d=new Image).onload=()=>{let b=d.naturalWidth,c=d.naturalHeight;d=null,((b,c)=>{a.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE",{id:e,width:b,height:c})})(b,c)},d.src=c)},DID_FINISH_CALCULATE_PREVIEWSIZE:({root:a,props:b})=>{var c;let g,h,{id:i}=b,j=a.query("GET_ITEM",i);if(!j)return;let k=URL.createObjectURL(j.file),l=()=>{new Promise((a,b)=>{let c=new Image;c.crossOrigin="Anonymous",c.onload=()=>{a(c)},c.onerror=a=>{b(a)},c.src=k}).then(m)},m=c=>{var d,g,h,i;let l,m;URL.revokeObjectURL(k);let n=(j.getMetadata("exif")||{}).orientation||-1,{width:o,height:p}=c;if(!o||!p)return;n>=5&&n<=8&&([o,p]=[p,o]);let q=Math.max(1,.75*window.devicePixelRatio),r=a.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR")*q,s=p/o,t=a.rect.element.width,u=a.rect.element.height,v=t,w=v*s;s>1?w=(v=Math.min(o,t*r))*s:v=(w=Math.min(p,u*r))/s;let x=(d=v,g=w,d=Math.round(d),g=Math.round(g),(l=document.createElement("canvas")).width=d,l.height=g,m=l.getContext("2d"),n>=5&&n<=8&&([d,g]=[g,d]),h=d,i=g,-1!==n&&m.transform.apply(m,F[n](h,i)),m.drawImage(c,0,0,d,g),l),y=()=>{let d=a.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR")?(a=>{let b=Math.min(10/a.width,10/a.height),c=document.createElement("canvas"),d=c.getContext("2d"),e=c.width=Math.ceil(a.width*b),f=c.height=Math.ceil(a.height*b);d.drawImage(a,0,0,e,f);let g=null;try{g=d.getImageData(0,0,e,f).data}catch(a){return null}let h=g.length,i=0,j=0,k=0,l=0;for(;l<h;l+=4)i+=g[l]*g[l],j+=g[l+1]*g[l+1],k+=g[l+2]*g[l+2];return i=H(i,h),{r:i,g:j=H(j,h),b:k=H(k,h)}})(data):null;j.setMetadata("color",d,!0),"close"in c&&c.close(),a.ref.overlayShadow.opacity=1,f({root:a,props:b,image:x})},z=j.getMetadata("filter");z?e(a,z,x).then(y):y()};if(c=j.file,(null===(h=(g=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./))?parseInt(g[1]):null)||!(h<=58))&&"createImageBitmap"in window&&G(c)){let a=d(D);a.post({file:j.file},b=>{(a.terminate(),b)?m(b):l()})}else l()},DID_UPDATE_ITEM_METADATA:({root:a,props:b,action:c})=>{if(!/crop|filter|markup|resize/.test(c.change.key)||!a.ref.images.length)return;let d=a.query("GET_ITEM",{id:b.id});if(d){if(/filter/.test(c.change.key)){let b=a.ref.images[a.ref.images.length-1];e(a,c.change.value,b.image);return}if(/crop|markup|resize/.test(c.change.key)){let c=d.getMetadata("crop"),e=a.ref.images[a.ref.images.length-1];if(c&&c.aspectRatio&&e.crop&&e.crop.aspectRatio&&Math.abs(c.aspectRatio-e.crop.aspectRatio)>1e-5){var g,h;let c=(({root:a})=>{let b=a.ref.images.shift();return b.opacity=0,b.translateY=-15,a.ref.imageViewBin.push(b),b})({root:a});f({root:a,props:b,image:(g=c.image,(h=h||document.createElement("canvas")).width=g.width,h.height=g.height,h.getContext("2d").drawImage(g,0,0),h)})}else(({root:a,props:b})=>{let c=a.query("GET_ITEM",{id:b.id});if(!c)return;let d=a.ref.images[a.ref.images.length-1];d.crop=c.getMetadata("crop"),d.background=a.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),a.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(d.dirty=!0,d.resize=c.getMetadata("resize"),d.markup=c.getMetadata("markup"))})({root:a,props:b})}}},DID_THROW_ITEM_LOAD_ERROR:h,DID_THROW_ITEM_PROCESSING_ERROR:h,DID_THROW_ITEM_INVALID:h,DID_COMPLETE_ITEM_PROCESSING:({root:a})=>{a.ref.overlayShadow.opacity=.25,a.ref.overlaySuccess.opacity=1},DID_START_ITEM_PROCESSING:g,DID_REVERT_ITEM_PROCESSING:g},({root:a})=>{let b=a.ref.imageViewBin.filter(a=>0===a.opacity);a.ref.imageViewBin=a.ref.imageViewBin.filter(a=>a.opacity>0),b.forEach(b=>{a.removeChildView(b),b.image.width=1,b.image.height=1,b._destroy()}),b.length=0})})})(a);return b("CREATE_VIEW",a=>{let{is:b,view:c,query:d}=a;if(!b("file")||!d("GET_ALLOW_IMAGE_PREVIEW"))return;let h=({root:a})=>{a.ref.shouldRescale=!0};c.registerWriter(e({DID_RESIZE_ROOT:h,DID_STOP_RESIZE:h,DID_LOAD_ITEM:({root:a,props:b})=>{let{id:e}=b,h=d("GET_ITEM",e);if(!h||!f(h.file)||h.archived)return;let i=h.file;if(!/^image/.test(i.type)||!d("GET_IMAGE_PREVIEW_FILTER_ITEM")(h))return;let j="createImageBitmap"in(window||{}),k=d("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");if(!j&&k&&i.size>k)return;a.ref.imagePreview=c.appendChildView(c.createChildView(g,{id:e}));let l=a.query("GET_IMAGE_PREVIEW_HEIGHT");l&&a.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:h.id,height:l});let m=!j&&i.size>d("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");a.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE",{id:e},m)},DID_IMAGE_PREVIEW_CALCULATE_SIZE:({root:a,action:b})=>{a.ref.imageWidth=b.width,a.ref.imageHeight=b.height,a.ref.shouldRescale=!0,a.ref.shouldDrawPreview=!0,a.dispatch("KICK")},DID_UPDATE_ITEM_METADATA:({root:a,action:b})=>{"crop"===b.change.key&&(a.ref.shouldRescale=!0)}},({root:a,props:b})=>{a.ref.imagePreview&&!a.rect.element.hidden&&(a.ref.shouldRescale&&(((a,b)=>{if(!a.ref.imagePreview)return;let{id:c}=b,d=a.query("GET_ITEM",{id:c});if(!d)return;let e=a.query("GET_PANEL_ASPECT_RATIO"),f=a.query("GET_ITEM_PANEL_ASPECT_RATIO"),g=a.query("GET_IMAGE_PREVIEW_HEIGHT");if(e||f||g)return;let{imageWidth:h,imageHeight:i}=a.ref;if(!h||!i)return;let j=a.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),k=a.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),l=(d.getMetadata("exif")||{}).orientation||-1;if(l>=5&&l<=8&&([h,i]=[i,h]),!G(d.file)||a.query("GET_IMAGE_PREVIEW_UPSCALE")){let a=2048/h;h*=a,i*=a}let m=i/h,n=(d.getMetadata("crop")||{}).aspectRatio||m,o=Math.max(j,Math.min(i,k)),p=Math.min(a.rect.element.width*n,o);a.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:d.id,height:p})})(a,b),a.ref.shouldRescale=!1),a.ref.shouldDrawPreview&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{a.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE",{id:b.id})})}),a.ref.shouldDrawPreview=!1))}))}),{options:{allowImagePreview:[!0,d.BOOLEAN],imagePreviewFilterItem:[()=>!0,d.FUNCTION],imagePreviewHeight:[null,d.INT],imagePreviewMinHeight:[44,d.INT],imagePreviewMaxHeight:[256,d.INT],imagePreviewMaxFileSize:[null,d.INT],imagePreviewZoomFactor:[2,d.INT],imagePreviewUpscale:[!1,d.BOOLEAN],imagePreviewMaxInstantPreviewFileSize:[1e6,d.INT],imagePreviewTransparencyIndicator:[null,d.STRING],imagePreviewCalculateAverageImageColor:[!1,d.BOOLEAN],imagePreviewMarkupShow:[!0,d.BOOLEAN],imagePreviewMarkupFilter:[()=>!0,d.FUNCTION]}}}],390599)}];

//# sourceMappingURL=8fe28_-image-exif-orientation_dist_filepond-plugin-image-exif-orientation_esm_79be0895.js.map