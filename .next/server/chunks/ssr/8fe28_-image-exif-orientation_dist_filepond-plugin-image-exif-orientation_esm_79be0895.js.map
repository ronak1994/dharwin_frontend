{"version":3,"sources":["../../../../../../Desktop/dharwin_boilerplate/node_modules/filepond-plugin-image-exif-orientation/dist/filepond-plugin-image-exif-orientation.esm.js","../../../../../../Desktop/dharwin_boilerplate/node_modules/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.esm.js"],"sourcesContent":["/*!\n * FilePondPluginImageExifOrientation 1.0.11\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n// test if file is of type image\nconst isJPEG = file => /^image\\/jpeg/.test(file.type);\n\nconst Marker = {\n  JPEG: 0xffd8,\n  APP1: 0xffe1,\n  EXIF: 0x45786966,\n  TIFF: 0x4949,\n  Orientation: 0x0112,\n  Unknown: 0xff00\n};\n\nconst getUint16 = (view, offset, little = false) =>\n  view.getUint16(offset, little);\nconst getUint32 = (view, offset, little = false) =>\n  view.getUint32(offset, little);\n\nconst getImageOrientation = file =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = function(e) {\n      const view = new DataView(e.target.result);\n\n      // Every JPEG file starts from binary value '0xFFD8'\n      if (getUint16(view, 0) !== Marker.JPEG) {\n        // This aint no JPEG\n        resolve(-1);\n        return;\n      }\n\n      const length = view.byteLength;\n      let offset = 2;\n\n      while (offset < length) {\n        const marker = getUint16(view, offset);\n        offset += 2;\n\n        // There's our APP1 Marker\n        if (marker === Marker.APP1) {\n          if (getUint32(view, (offset += 2)) !== Marker.EXIF) {\n            // no EXIF info defined\n            break;\n          }\n\n          // Get TIFF Header\n          const little = getUint16(view, (offset += 6)) === Marker.TIFF;\n          offset += getUint32(view, offset + 4, little);\n\n          const tags = getUint16(view, offset, little);\n          offset += 2;\n\n          for (let i = 0; i < tags; i++) {\n            // found the orientation tag\n            if (\n              getUint16(view, offset + i * 12, little) === Marker.Orientation\n            ) {\n              resolve(getUint16(view, offset + i * 12 + 8, little));\n              return;\n            }\n          }\n        } else if ((marker & Marker.Unknown) !== Marker.Unknown) {\n          // Invalid\n          break;\n        } else {\n          offset += getUint16(view, offset);\n        }\n      }\n\n      // Nothing found\n      resolve(-1);\n    };\n\n    // we don't need to read the entire file to get the orientation\n    reader.readAsArrayBuffer(file.slice(0, 64 * 1024));\n  });\n\nconst IS_BROWSER = (() =>\n  typeof window !== 'undefined' && typeof window.document !== 'undefined')();\nconst isBrowser = () => IS_BROWSER;\n\n// 2x1 pixel image 90CW rotated with orientation header\nconst testSrc =\n  'data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=';\n\n// should correct orientation if is presented in landscape, in which case the browser doesn't autocorrect\nlet shouldCorrect = undefined;\nconst testImage = isBrowser() ? new Image() : {};\ntestImage.onload = () =>\n  (shouldCorrect = testImage.naturalWidth > testImage.naturalHeight);\ntestImage.src = testSrc;\n\nconst shouldCorrectImageExifOrientation = () => shouldCorrect;\n\n/**\n * Read Image Orientation Plugin\n */\nconst plugin = ({ addFilter, utils }) => {\n  const { Type, isFile } = utils;\n\n  // subscribe to file load and append required info\n  addFilter(\n    'DID_LOAD_ITEM',\n    (item, { query }) =>\n      new Promise((resolve, reject) => {\n        // get file reference\n        const file = item.file;\n\n        // if this is not a jpeg image we are not interested\n        if (\n          !isFile(file) ||\n          !isJPEG(file) ||\n          !query('GET_ALLOW_IMAGE_EXIF_ORIENTATION') ||\n          !shouldCorrectImageExifOrientation()\n        ) {\n          // continue with the unaltered dataset\n          return resolve(item);\n        }\n\n        // get orientation from exif data\n        getImageOrientation(file).then(orientation => {\n          item.setMetadata('exif', { orientation });\n          resolve(item);\n        });\n      })\n  );\n\n  // Expose plugin options\n  return {\n    options: {\n      // Enable or disable image orientation reading\n      allowImageExifOrientation: [true, Type.BOOLEAN]\n    }\n  };\n};\n\n// fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\nconst isBrowser$1 =\n  typeof window !== 'undefined' && typeof window.document !== 'undefined';\nif (isBrowser$1) {\n  document.dispatchEvent(\n    new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n  );\n}\n\nexport default plugin;\n","/*!\n * FilePondPluginImagePreview 4.6.12\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n// test if file is of type image and can be viewed in canvas\nconst isPreviewableImage = file => /^image/.test(file.type);\n\nconst vectorMultiply = (v, amount) => createVector(v.x * amount, v.y * amount);\n\nconst vectorAdd = (a, b) => createVector(a.x + b.x, a.y + b.y);\n\nconst vectorNormalize = v => {\n  const l = Math.sqrt(v.x * v.x + v.y * v.y);\n  if (l === 0) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n  return createVector(v.x / l, v.y / l);\n};\n\nconst vectorRotate = (v, radians, origin) => {\n  const cos = Math.cos(radians);\n  const sin = Math.sin(radians);\n  const t = createVector(v.x - origin.x, v.y - origin.y);\n  return createVector(\n    origin.x + cos * t.x - sin * t.y,\n    origin.y + sin * t.x + cos * t.y\n  );\n};\n\nconst createVector = (x = 0, y = 0) => ({ x, y });\n\nconst getMarkupValue = (value, size, scalar = 1, axis) => {\n  if (typeof value === 'string') {\n    return parseFloat(value) * scalar;\n  }\n  if (typeof value === 'number') {\n    return value * (axis ? size[axis] : Math.min(size.width, size.height));\n  }\n  return;\n};\n\nconst getMarkupStyles = (markup, size, scale) => {\n  const lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n  const fill = markup.backgroundColor || markup.fontColor || 'transparent';\n  const stroke = markup.borderColor || markup.lineColor || 'transparent';\n  const strokeWidth = getMarkupValue(\n    markup.borderWidth || markup.lineWidth,\n    size,\n    scale\n  );\n  const lineCap = markup.lineCap || 'round';\n  const lineJoin = markup.lineJoin || 'round';\n  const dashes =\n    typeof lineStyle === 'string'\n      ? ''\n      : lineStyle.map(v => getMarkupValue(v, size, scale)).join(',');\n  const opacity = markup.opacity || 1;\n  return {\n    'stroke-linecap': lineCap,\n    'stroke-linejoin': lineJoin,\n    'stroke-width': strokeWidth || 0,\n    'stroke-dasharray': dashes,\n    stroke,\n    fill,\n    opacity\n  };\n};\n\nconst isDefined = value => value != null;\n\nconst getMarkupRect = (rect, size, scalar = 1) => {\n  let left =\n    getMarkupValue(rect.x, size, scalar, 'width') ||\n    getMarkupValue(rect.left, size, scalar, 'width');\n  let top =\n    getMarkupValue(rect.y, size, scalar, 'height') ||\n    getMarkupValue(rect.top, size, scalar, 'height');\n  let width = getMarkupValue(rect.width, size, scalar, 'width');\n  let height = getMarkupValue(rect.height, size, scalar, 'height');\n  let right = getMarkupValue(rect.right, size, scalar, 'width');\n  let bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n  if (!isDefined(top)) {\n    if (isDefined(height) && isDefined(bottom)) {\n      top = size.height - height - bottom;\n    } else {\n      top = bottom;\n    }\n  }\n\n  if (!isDefined(left)) {\n    if (isDefined(width) && isDefined(right)) {\n      left = size.width - width - right;\n    } else {\n      left = right;\n    }\n  }\n\n  if (!isDefined(width)) {\n    if (isDefined(left) && isDefined(right)) {\n      width = size.width - left - right;\n    } else {\n      width = 0;\n    }\n  }\n\n  if (!isDefined(height)) {\n    if (isDefined(top) && isDefined(bottom)) {\n      height = size.height - top - bottom;\n    } else {\n      height = 0;\n    }\n  }\n\n  return {\n    x: left || 0,\n    y: top || 0,\n    width: width || 0,\n    height: height || 0\n  };\n};\n\nconst pointsToPathShape = points =>\n  points\n    .map((point, index) => `${index === 0 ? 'M' : 'L'} ${point.x} ${point.y}`)\n    .join(' ');\n\nconst setAttributes = (element, attr) =>\n  Object.keys(attr).forEach(key => element.setAttribute(key, attr[key]));\n\nconst ns = 'http://www.w3.org/2000/svg';\nconst svg = (tag, attr) => {\n  const element = document.createElementNS(ns, tag);\n  if (attr) {\n    setAttributes(element, attr);\n  }\n  return element;\n};\n\nconst updateRect = element =>\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles\n  });\n\nconst updateEllipse = element => {\n  const cx = element.rect.x + element.rect.width * 0.5;\n  const cy = element.rect.y + element.rect.height * 0.5;\n  const rx = element.rect.width * 0.5;\n  const ry = element.rect.height * 0.5;\n  return setAttributes(element, {\n    cx,\n    cy,\n    rx,\n    ry,\n    ...element.styles\n  });\n};\n\nconst IMAGE_FIT_STYLE = {\n  contain: 'xMidYMid meet',\n  cover: 'xMidYMid slice'\n};\n\nconst updateImage = (element, markup) => {\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles,\n    preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n  });\n};\n\nconst TEXT_ANCHOR = {\n  left: 'start',\n  center: 'middle',\n  right: 'end'\n};\n\nconst updateText = (element, markup, size, scale) => {\n  const fontSize = getMarkupValue(markup.fontSize, size, scale);\n  const fontFamily = markup.fontFamily || 'sans-serif';\n  const fontWeight = markup.fontWeight || 'normal';\n  const textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles,\n    'stroke-width': 0,\n    'font-weight': fontWeight,\n    'font-size': fontSize,\n    'font-family': fontFamily,\n    'text-anchor': textAlign\n  });\n\n  // update text\n  if (element.text !== markup.text) {\n    element.text = markup.text;\n    element.textContent = markup.text.length ? markup.text : ' ';\n  }\n};\n\nconst updateLine = (element, markup, size, scale) => {\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles,\n    fill: 'none'\n  });\n\n  const line = element.childNodes[0];\n  const begin = element.childNodes[1];\n  const end = element.childNodes[2];\n\n  const origin = element.rect;\n\n  const target = {\n    x: element.rect.x + element.rect.width,\n    y: element.rect.y + element.rect.height\n  };\n\n  setAttributes(line, {\n    x1: origin.x,\n    y1: origin.y,\n    x2: target.x,\n    y2: target.y\n  });\n\n  if (!markup.lineDecoration) return;\n\n  begin.style.display = 'none';\n  end.style.display = 'none';\n\n  const v = vectorNormalize({\n    x: target.x - origin.x,\n    y: target.y - origin.y\n  });\n\n  const l = getMarkupValue(0.05, size, scale);\n\n  if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n    const arrowBeginRotationPoint = vectorMultiply(v, l);\n    const arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n    const arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n    const arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n    setAttributes(begin, {\n      style: 'display:block;',\n      d: `M${arrowBeginA.x},${arrowBeginA.y} L${origin.x},${origin.y} L${\n        arrowBeginB.x\n      },${arrowBeginB.y}`\n    });\n  }\n\n  if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n    const arrowEndRotationPoint = vectorMultiply(v, -l);\n    const arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n    const arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n    const arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n    setAttributes(end, {\n      style: 'display:block;',\n      d: `M${arrowEndA.x},${arrowEndA.y} L${target.x},${target.y} L${\n        arrowEndB.x\n      },${arrowEndB.y}`\n    });\n  }\n};\n\nconst updatePath = (element, markup, size, scale) => {\n  setAttributes(element, {\n    ...element.styles,\n    fill: 'none',\n    d: pointsToPathShape(\n      markup.points.map(point => ({\n        x: getMarkupValue(point.x, size, scale, 'width'),\n        y: getMarkupValue(point.y, size, scale, 'height')\n      }))\n    )\n  });\n};\n\nconst createShape = node => markup => svg(node, { id: markup.id });\n\nconst createImage = markup => {\n  const shape = svg('image', {\n    id: markup.id,\n    'stroke-linecap': 'round',\n    'stroke-linejoin': 'round',\n    opacity: '0'\n  });\n  shape.onload = () => {\n    shape.setAttribute('opacity', markup.opacity || 1);\n  };\n  shape.setAttributeNS(\n    'http://www.w3.org/1999/xlink',\n    'xlink:href',\n    markup.src\n  );\n  return shape;\n};\n\nconst createLine = markup => {\n  const shape = svg('g', {\n    id: markup.id,\n    'stroke-linecap': 'round',\n    'stroke-linejoin': 'round'\n  });\n\n  const line = svg('line');\n  shape.appendChild(line);\n\n  const begin = svg('path');\n  shape.appendChild(begin);\n\n  const end = svg('path');\n  shape.appendChild(end);\n\n  return shape;\n};\n\nconst CREATE_TYPE_ROUTES = {\n  image: createImage,\n  rect: createShape('rect'),\n  ellipse: createShape('ellipse'),\n  text: createShape('text'),\n  path: createShape('path'),\n  line: createLine\n};\n\nconst UPDATE_TYPE_ROUTES = {\n  rect: updateRect,\n  ellipse: updateEllipse,\n  image: updateImage,\n  text: updateText,\n  path: updatePath,\n  line: updateLine\n};\n\nconst createMarkupByType = (type, markup) => CREATE_TYPE_ROUTES[type](markup);\n\nconst updateMarkupByType = (element, type, markup, size, scale) => {\n  if (type !== 'path') {\n    element.rect = getMarkupRect(markup, size, scale);\n  }\n  element.styles = getMarkupStyles(markup, size, scale);\n  UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n};\n\nconst MARKUP_RECT = [\n  'x',\n  'y',\n  'left',\n  'top',\n  'right',\n  'bottom',\n  'width',\n  'height'\n];\n\nconst toOptionalFraction = value =>\n  typeof value === 'string' && /%/.test(value)\n    ? parseFloat(value) / 100\n    : value;\n\n// adds default markup properties, clones markup\nconst prepareMarkup = markup => {\n  const [type, props] = markup;\n\n  const rect = props.points\n    ? {}\n    : MARKUP_RECT.reduce((prev, curr) => {\n        prev[curr] = toOptionalFraction(props[curr]);\n        return prev;\n      }, {});\n\n  return [\n    type,\n    {\n      zIndex: 0,\n      ...props,\n      ...rect\n    }\n  ];\n};\n\nconst sortMarkupByZIndex = (a, b) => {\n  if (a[1].zIndex > b[1].zIndex) {\n    return 1;\n  }\n  if (a[1].zIndex < b[1].zIndex) {\n    return -1;\n  }\n  return 0;\n};\n\nconst createMarkupView = _ =>\n  _.utils.createView({\n    name: 'image-preview-markup',\n    tag: 'svg',\n    ignoreRect: true,\n    mixins: {\n      apis: ['width', 'height', 'crop', 'markup', 'resize', 'dirty']\n    },\n    write: ({ root, props }) => {\n      if (!props.dirty) return;\n\n      const { crop, resize, markup } = props;\n\n      const viewWidth = props.width;\n      const viewHeight = props.height;\n\n      let cropWidth = crop.width;\n      let cropHeight = crop.height;\n\n      if (resize) {\n        const { size } = resize;\n\n        let outputWidth = size && size.width;\n        let outputHeight = size && size.height;\n        const outputFit = resize.mode;\n        const outputUpscale = resize.upscale;\n\n        if (outputWidth && !outputHeight) outputHeight = outputWidth;\n        if (outputHeight && !outputWidth) outputWidth = outputHeight;\n\n        const shouldUpscale =\n          cropWidth < outputWidth && cropHeight < outputHeight;\n\n        if (!shouldUpscale || (shouldUpscale && outputUpscale)) {\n          let scalarWidth = outputWidth / cropWidth;\n          let scalarHeight = outputHeight / cropHeight;\n\n          if (outputFit === 'force') {\n            cropWidth = outputWidth;\n            cropHeight = outputHeight;\n          } else {\n            let scalar;\n            if (outputFit === 'cover') {\n              scalar = Math.max(scalarWidth, scalarHeight);\n            } else if (outputFit === 'contain') {\n              scalar = Math.min(scalarWidth, scalarHeight);\n            }\n            cropWidth = cropWidth * scalar;\n            cropHeight = cropHeight * scalar;\n          }\n        }\n      }\n\n      const size = {\n        width: viewWidth,\n        height: viewHeight\n      };\n\n      root.element.setAttribute('width', size.width);\n      root.element.setAttribute('height', size.height);\n\n      const scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight);\n\n      // clear\n      root.element.innerHTML = '';\n\n      // get filter\n      const markupFilter = root.query('GET_IMAGE_PREVIEW_MARKUP_FILTER');\n\n      // draw new\n      markup\n        .filter(markupFilter)\n        .map(prepareMarkup)\n        .sort(sortMarkupByZIndex)\n        .forEach(markup => {\n          const [type, settings] = markup;\n\n          // create\n          const element = createMarkupByType(type, settings);\n\n          // update\n          updateMarkupByType(element, type, settings, size, scale);\n\n          // add\n          root.element.appendChild(element);\n        });\n    }\n  });\n\nconst createVector$1 = (x, y) => ({ x, y });\n\nconst vectorDot = (a, b) => a.x * b.x + a.y * b.y;\n\nconst vectorSubtract = (a, b) => createVector$1(a.x - b.x, a.y - b.y);\n\nconst vectorDistanceSquared = (a, b) =>\n  vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n\nconst vectorDistance = (a, b) => Math.sqrt(vectorDistanceSquared(a, b));\n\nconst getOffsetPointOnEdge = (length, rotation) => {\n  const a = length;\n\n  const A = 1.5707963267948966;\n  const B = rotation;\n  const C = 1.5707963267948966 - rotation;\n\n  const sinA = Math.sin(A);\n  const sinB = Math.sin(B);\n  const sinC = Math.sin(C);\n  const cosC = Math.cos(C);\n  const ratio = a / sinA;\n  const b = ratio * sinB;\n  const c = ratio * sinC;\n\n  return createVector$1(cosC * b, cosC * c);\n};\n\nconst getRotatedRectSize = (rect, rotation) => {\n  const w = rect.width;\n  const h = rect.height;\n\n  const hor = getOffsetPointOnEdge(w, rotation);\n  const ver = getOffsetPointOnEdge(h, rotation);\n\n  const tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n\n  const tr = createVector$1(\n    rect.x + rect.width + Math.abs(ver.y),\n    rect.y + Math.abs(ver.x)\n  );\n\n  const bl = createVector$1(\n    rect.x - Math.abs(ver.y),\n    rect.y + rect.height - Math.abs(ver.x)\n  );\n\n  return {\n    width: vectorDistance(tl, tr),\n    height: vectorDistance(tl, bl)\n  };\n};\n\nconst calculateCanvasSize = (image, canvasAspectRatio, zoom = 1) => {\n  const imageAspectRatio = image.height / image.width;\n\n  // determine actual pixels on x and y axis\n  let canvasWidth = 1;\n  let canvasHeight = canvasAspectRatio;\n  let imgWidth = 1;\n  let imgHeight = imageAspectRatio;\n  if (imgHeight > canvasHeight) {\n    imgHeight = canvasHeight;\n    imgWidth = imgHeight / imageAspectRatio;\n  }\n\n  const scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n  const width = image.width / (zoom * scalar * imgWidth);\n  const height = width * canvasAspectRatio;\n\n  return {\n    width: width,\n    height: height\n  };\n};\n\nconst getImageRectZoomFactor = (imageRect, cropRect, rotation, center) => {\n  // calculate available space round image center position\n  const cx = center.x > 0.5 ? 1 - center.x : center.x;\n  const cy = center.y > 0.5 ? 1 - center.y : center.y;\n  const imageWidth = cx * 2 * imageRect.width;\n  const imageHeight = cy * 2 * imageRect.height;\n\n  // calculate rotated crop rectangle size\n  const rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n  // calculate scalar required to fit image\n  return Math.max(\n    rotatedCropSize.width / imageWidth,\n    rotatedCropSize.height / imageHeight\n  );\n};\n\nconst getCenteredCropRect = (container, aspectRatio) => {\n  let width = container.width;\n  let height = width * aspectRatio;\n  if (height > container.height) {\n    height = container.height;\n    width = height / aspectRatio;\n  }\n  const x = (container.width - width) * 0.5;\n  const y = (container.height - height) * 0.5;\n\n  return {\n    x,\n    y,\n    width,\n    height\n  };\n};\n\nconst getCurrentCropSize = (imageSize, crop = {}) => {\n  let { zoom, rotation, center, aspectRatio } = crop;\n\n  if (!aspectRatio) aspectRatio = imageSize.height / imageSize.width;\n\n  const canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n\n  const canvasCenter = {\n    x: canvasSize.width * 0.5,\n    y: canvasSize.height * 0.5\n  };\n\n  const stage = {\n    x: 0,\n    y: 0,\n    width: canvasSize.width,\n    height: canvasSize.height,\n    center: canvasCenter\n  };\n\n  const shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n  const stageZoomFactor = getImageRectZoomFactor(\n    imageSize,\n    getCenteredCropRect(stage, aspectRatio),\n    rotation,\n    shouldLimit ? center : { x: 0.5, y: 0.5 }\n  );\n\n  const scale = zoom * stageZoomFactor;\n\n  // start drawing\n  return {\n    widthFloat: canvasSize.width / scale,\n    heightFloat: canvasSize.height / scale,\n    width: Math.round(canvasSize.width / scale),\n    height: Math.round(canvasSize.height / scale)\n  };\n};\n\nconst IMAGE_SCALE_SPRING_PROPS = {\n  type: 'spring',\n  stiffness: 0.5,\n  damping: 0.45,\n  mass: 10\n};\n\n// does horizontal and vertical flipping\nconst createBitmapView = _ =>\n  _.utils.createView({\n    name: 'image-bitmap',\n    ignoreRect: true,\n    mixins: { styles: ['scaleX', 'scaleY'] },\n    create: ({ root, props }) => {\n      root.appendChild(props.image);\n    }\n  });\n\n// shifts and rotates image\nconst createImageCanvasWrapper = _ =>\n  _.utils.createView({\n    name: 'image-canvas-wrapper',\n    tag: 'div',\n    ignoreRect: true,\n    mixins: {\n      apis: ['crop', 'width', 'height'],\n      styles: [\n        'originX',\n        'originY',\n        'translateX',\n        'translateY',\n        'scaleX',\n        'scaleY',\n        'rotateZ'\n      ],\n      animations: {\n        originX: IMAGE_SCALE_SPRING_PROPS,\n        originY: IMAGE_SCALE_SPRING_PROPS,\n        scaleX: IMAGE_SCALE_SPRING_PROPS,\n        scaleY: IMAGE_SCALE_SPRING_PROPS,\n        translateX: IMAGE_SCALE_SPRING_PROPS,\n        translateY: IMAGE_SCALE_SPRING_PROPS,\n        rotateZ: IMAGE_SCALE_SPRING_PROPS\n      }\n    },\n    create: ({ root, props }) => {\n      props.width = props.image.width;\n      props.height = props.image.height;\n      root.ref.bitmap = root.appendChildView(\n        root.createChildView(createBitmapView(_), { image: props.image })\n      );\n    },\n    write: ({ root, props }) => {\n      const { flip } = props.crop;\n      const { bitmap } = root.ref;\n      bitmap.scaleX = flip.horizontal ? -1 : 1;\n      bitmap.scaleY = flip.vertical ? -1 : 1;\n    }\n  });\n\n// clips canvas to correct aspect ratio\nconst createClipView = _ =>\n  _.utils.createView({\n    name: 'image-clip',\n    tag: 'div',\n    ignoreRect: true,\n    mixins: {\n      apis: [\n        'crop',\n        'markup',\n        'resize',\n        'width',\n        'height',\n        'dirty',\n        'background'\n      ],\n      styles: ['width', 'height', 'opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 250 }\n      }\n    },\n    didWriteView: function({ root, props }) {\n      if (!props.background) return;\n      root.element.style.backgroundColor = props.background;\n    },\n    create: ({ root, props }) => {\n      root.ref.image = root.appendChildView(\n        root.createChildView(\n          createImageCanvasWrapper(_),\n          Object.assign({}, props)\n        )\n      );\n\n      root.ref.createMarkup = () => {\n        if (root.ref.markup) return;\n        root.ref.markup = root.appendChildView(\n          root.createChildView(createMarkupView(_), Object.assign({}, props))\n        );\n      };\n\n      root.ref.destroyMarkup = () => {\n        if (!root.ref.markup) return;\n        root.removeChildView(root.ref.markup);\n        root.ref.markup = null;\n      };\n\n      // set up transparency grid\n      const transparencyIndicator = root.query(\n        'GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR'\n      );\n      if (transparencyIndicator === null) return;\n\n      // grid pattern\n      if (transparencyIndicator === 'grid') {\n        root.element.dataset.transparencyIndicator = transparencyIndicator;\n      }\n      // basic color\n      else {\n        root.element.dataset.transparencyIndicator = 'color';\n      }\n    },\n    write: ({ root, props, shouldOptimize }) => {\n      const { crop, markup, resize, dirty, width, height } = props;\n\n      root.ref.image.crop = crop;\n\n      const stage = {\n        x: 0,\n        y: 0,\n        width,\n        height,\n        center: {\n          x: width * 0.5,\n          y: height * 0.5\n        }\n      };\n\n      const image = {\n        width: root.ref.image.width,\n        height: root.ref.image.height\n      };\n\n      const origin = {\n        x: crop.center.x * image.width,\n        y: crop.center.y * image.height\n      };\n\n      const translation = {\n        x: stage.center.x - image.width * crop.center.x,\n        y: stage.center.y - image.height * crop.center.y\n      };\n\n      const rotation = Math.PI * 2 + (crop.rotation % (Math.PI * 2));\n\n      const cropAspectRatio = crop.aspectRatio || image.height / image.width;\n\n      const shouldLimit =\n        typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n      const stageZoomFactor = getImageRectZoomFactor(\n        image,\n        getCenteredCropRect(stage, cropAspectRatio),\n        rotation,\n        shouldLimit ? crop.center : { x: 0.5, y: 0.5 }\n      );\n\n      const scale = crop.zoom * stageZoomFactor;\n\n      // update markup view\n      if (markup && markup.length) {\n        root.ref.createMarkup();\n        root.ref.markup.width = width;\n        root.ref.markup.height = height;\n        root.ref.markup.resize = resize;\n        root.ref.markup.dirty = dirty;\n        root.ref.markup.markup = markup;\n        root.ref.markup.crop = getCurrentCropSize(image, crop);\n      } else if (root.ref.markup) {\n        root.ref.destroyMarkup();\n      }\n\n      // update image view\n      const imageView = root.ref.image;\n\n      // don't update clip layout\n      if (shouldOptimize) {\n        imageView.originX = null;\n        imageView.originY = null;\n        imageView.translateX = null;\n        imageView.translateY = null;\n        imageView.rotateZ = null;\n        imageView.scaleX = null;\n        imageView.scaleY = null;\n        return;\n      }\n\n      imageView.originX = origin.x;\n      imageView.originY = origin.y;\n      imageView.translateX = translation.x;\n      imageView.translateY = translation.y;\n      imageView.rotateZ = rotation;\n      imageView.scaleX = scale;\n      imageView.scaleY = scale;\n    }\n  });\n\nconst createImageView = _ =>\n  _.utils.createView({\n    name: 'image-preview',\n    tag: 'div',\n    ignoreRect: true,\n    mixins: {\n      apis: ['image', 'crop', 'markup', 'resize', 'dirty', 'background'],\n      styles: ['translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: IMAGE_SCALE_SPRING_PROPS,\n        scaleY: IMAGE_SCALE_SPRING_PROPS,\n        translateY: IMAGE_SCALE_SPRING_PROPS,\n        opacity: { type: 'tween', duration: 400 }\n      }\n    },\n    create: ({ root, props }) => {\n      root.ref.clip = root.appendChildView(\n        root.createChildView(createClipView(_), {\n          id: props.id,\n          image: props.image,\n          crop: props.crop,\n          markup: props.markup,\n          resize: props.resize,\n          dirty: props.dirty,\n          background: props.background\n        })\n      );\n    },\n    write: ({ root, props, shouldOptimize }) => {\n      const { clip } = root.ref;\n\n      const { image, crop, markup, resize, dirty } = props;\n\n      clip.crop = crop;\n      clip.markup = markup;\n      clip.resize = resize;\n      clip.dirty = dirty;\n\n      // don't update clip layout\n      clip.opacity = shouldOptimize ? 0 : 1;\n\n      // don't re-render if optimizing or hidden (width will be zero resulting in weird animations)\n      if (shouldOptimize || root.rect.element.hidden) return;\n\n      // calculate scaled preview image size\n      const imageAspectRatio = image.height / image.width;\n      let aspectRatio = crop.aspectRatio || imageAspectRatio;\n\n      // calculate container size\n      const containerWidth = root.rect.inner.width;\n      const containerHeight = root.rect.inner.height;\n\n      let fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n      const minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n      const maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n      const panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n      const allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n\n      if (panelAspectRatio && !allowMultiple) {\n        fixedPreviewHeight = containerWidth * panelAspectRatio;\n        aspectRatio = panelAspectRatio;\n      }\n\n      // determine clip width and height\n      let clipHeight =\n        fixedPreviewHeight !== null\n          ? fixedPreviewHeight\n          : Math.max(\n              minPreviewHeight,\n              Math.min(containerWidth * aspectRatio, maxPreviewHeight)\n            );\n\n      let clipWidth = clipHeight / aspectRatio;\n      if (clipWidth > containerWidth) {\n        clipWidth = containerWidth;\n        clipHeight = clipWidth * aspectRatio;\n      }\n\n      if (clipHeight > containerHeight) {\n        clipHeight = containerHeight;\n        clipWidth = containerHeight / aspectRatio;\n      }\n\n      clip.width = clipWidth;\n      clip.height = clipHeight;\n    }\n  });\n\nlet SVG_MASK = `<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\n    <defs>\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\n            <stop offset='50%' stop-color='#000000'/>\n            <stop offset='56%' stop-color='#0a0a0a'/>\n            <stop offset='63%' stop-color='#262626'/>\n            <stop offset='69%' stop-color='#4f4f4f'/>\n            <stop offset='75%' stop-color='#808080'/>\n            <stop offset='81%' stop-color='#b1b1b1'/>\n            <stop offset='88%' stop-color='#dadada'/>\n            <stop offset='94%' stop-color='#f6f6f6'/>\n            <stop offset='100%' stop-color='#ffffff'/>\n        </radialGradient>\n        <mask id=\"mask-__UID__\">\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\n        </mask>\n    </defs>\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\n</svg>`;\n\nlet SVGMaskUniqueId = 0;\n\nconst createImageOverlayView = fpAPI =>\n  fpAPI.utils.createView({\n    name: 'image-preview-overlay',\n    tag: 'div',\n    ignoreRect: true,\n    create: ({ root, props }) => {\n      let mask = SVG_MASK;\n      if (document.querySelector('base')) {\n        const url = new URL(\n          window.location.href.replace(window.location.hash, '')\n        ).href;\n        mask = mask.replace(/url\\(\\#/g, 'url(' + url + '#');\n      }\n\n      SVGMaskUniqueId++;\n      root.element.classList.add(\n        `filepond--image-preview-overlay-${props.status}`\n      );\n      root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);\n    },\n    mixins: {\n      styles: ['opacity'],\n      animations: {\n        opacity: { type: 'spring', mass: 25 }\n      }\n    }\n  });\n\n/**\n * Bitmap Worker\n */\nconst BitmapWorker = function() {\n  self.onmessage = e => {\n    createImageBitmap(e.data.message.file).then(bitmap => {\n      self.postMessage({ id: e.data.id, message: bitmap }, [bitmap]);\n    });\n  };\n};\n\n/**\n * ColorMatrix Worker\n */\nconst ColorMatrixWorker = function() {\n  self.onmessage = e => {\n    const imageData = e.data.message.imageData;\n    const matrix = e.data.message.colorMatrix;\n\n    const data = imageData.data;\n    const l = data.length;\n\n    const m11 = matrix[0];\n    const m12 = matrix[1];\n    const m13 = matrix[2];\n    const m14 = matrix[3];\n    const m15 = matrix[4];\n\n    const m21 = matrix[5];\n    const m22 = matrix[6];\n    const m23 = matrix[7];\n    const m24 = matrix[8];\n    const m25 = matrix[9];\n\n    const m31 = matrix[10];\n    const m32 = matrix[11];\n    const m33 = matrix[12];\n    const m34 = matrix[13];\n    const m35 = matrix[14];\n\n    const m41 = matrix[15];\n    const m42 = matrix[16];\n    const m43 = matrix[17];\n    const m44 = matrix[18];\n    const m45 = matrix[19];\n\n    let index = 0,\n      r = 0.0,\n      g = 0.0,\n      b = 0.0,\n      a = 0.0;\n\n    for (; index < l; index += 4) {\n      r = data[index] / 255;\n      g = data[index + 1] / 255;\n      b = data[index + 2] / 255;\n      a = data[index + 3] / 255;\n      data[index] = Math.max(\n        0,\n        Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255)\n      );\n      data[index + 1] = Math.max(\n        0,\n        Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255)\n      );\n      data[index + 2] = Math.max(\n        0,\n        Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255)\n      );\n      data[index + 3] = Math.max(\n        0,\n        Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255)\n      );\n    }\n\n    self.postMessage({ id: e.data.id, message: imageData }, [\n      imageData.data.buffer\n    ]);\n  };\n};\n\nconst getImageSize = (url, cb) => {\n  let image = new Image();\n  image.onload = () => {\n    const width = image.naturalWidth;\n    const height = image.naturalHeight;\n    image = null;\n    cb(width, height);\n  };\n  image.src = url;\n};\n\nconst transforms = {\n  1: () => [1, 0, 0, 1, 0, 0],\n  2: width => [-1, 0, 0, 1, width, 0],\n  3: (width, height) => [-1, 0, 0, -1, width, height],\n  4: (width, height) => [1, 0, 0, -1, 0, height],\n  5: () => [0, 1, 1, 0, 0, 0],\n  6: (width, height) => [0, 1, -1, 0, height, 0],\n  7: (width, height) => [0, -1, -1, 0, height, width],\n  8: width => [0, -1, 1, 0, 0, width]\n};\n\nconst fixImageOrientation = (ctx, width, height, orientation) => {\n  // no orientation supplied\n  if (orientation === -1) {\n    return;\n  }\n\n  ctx.transform.apply(ctx, transforms[orientation](width, height));\n};\n\n// draws the preview image to canvas\nconst createPreviewImage = (data, width, height, orientation) => {\n  // can't draw on half pixels\n  width = Math.round(width);\n  height = Math.round(height);\n\n  // draw image\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const ctx = canvas.getContext('2d');\n\n  // if is rotated incorrectly swap width and height\n  if (orientation >= 5 && orientation <= 8) {\n    [width, height] = [height, width];\n  }\n\n  // correct image orientation\n  fixImageOrientation(ctx, width, height, orientation);\n\n  // draw the image\n  ctx.drawImage(data, 0, 0, width, height);\n\n  return canvas;\n};\n\nconst isBitmap = file => /^image/.test(file.type) && !/svg/.test(file.type);\n\nconst MAX_WIDTH = 10;\nconst MAX_HEIGHT = 10;\n\nconst calculateAverageColor = image => {\n  const scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);\n\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  const width = (canvas.width = Math.ceil(image.width * scalar));\n  const height = (canvas.height = Math.ceil(image.height * scalar));\n  ctx.drawImage(image, 0, 0, width, height);\n  let data = null;\n  try {\n    data = ctx.getImageData(0, 0, width, height).data;\n  } catch (e) {\n    return null;\n  }\n  const l = data.length;\n\n  let r = 0;\n  let g = 0;\n  let b = 0;\n  let i = 0;\n\n  for (; i < l; i += 4) {\n    r += data[i] * data[i];\n    g += data[i + 1] * data[i + 1];\n    b += data[i + 2] * data[i + 2];\n  }\n\n  r = averageColor(r, l);\n  g = averageColor(g, l);\n  b = averageColor(b, l);\n\n  return { r, g, b };\n};\n\nconst averageColor = (c, l) => Math.floor(Math.sqrt(c / (l / 4)));\n\nconst cloneCanvas = (origin, target) => {\n  target = target || document.createElement('canvas');\n  target.width = origin.width;\n  target.height = origin.height;\n  const ctx = target.getContext('2d');\n  ctx.drawImage(origin, 0, 0);\n  return target;\n};\n\nconst cloneImageData = imageData => {\n  let id;\n  try {\n    id = new ImageData(imageData.width, imageData.height);\n  } catch (e) {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    id = ctx.createImageData(imageData.width, imageData.height);\n  }\n  id.data.set(new Uint8ClampedArray(imageData.data));\n  return id;\n};\n\nconst loadImage = url =>\n  new Promise((resolve, reject) => {\n    const img = new Image();\n    img.crossOrigin = 'Anonymous';\n    img.onload = () => {\n      resolve(img);\n    };\n    img.onerror = e => {\n      reject(e);\n    };\n    img.src = url;\n  });\n\nconst createImageWrapperView = _ => {\n  // create overlay view\n  const OverlayView = createImageOverlayView(_);\n\n  const ImageView = createImageView(_);\n\n  const { createWorker } = _.utils;\n\n  const applyFilter = (root, filter, target) =>\n    new Promise(resolve => {\n      // will store image data for future filter updates\n      if (!root.ref.imageData) {\n        root.ref.imageData = target\n          .getContext('2d')\n          .getImageData(0, 0, target.width, target.height);\n      }\n\n      // get image data reference\n      const imageData = cloneImageData(root.ref.imageData);\n\n      if (!filter || filter.length !== 20) {\n        target.getContext('2d').putImageData(imageData, 0, 0);\n        return resolve();\n      }\n\n      const worker = createWorker(ColorMatrixWorker);\n      worker.post(\n        {\n          imageData,\n          colorMatrix: filter\n        },\n        response => {\n          // apply filtered colors\n          target.getContext('2d').putImageData(response, 0, 0);\n\n          // stop worker\n          worker.terminate();\n\n          // done!\n          resolve();\n        },\n        [imageData.data.buffer]\n      );\n    });\n\n  const removeImageView = (root, imageView) => {\n    root.removeChildView(imageView);\n    imageView.image.width = 1;\n    imageView.image.height = 1;\n    imageView._destroy();\n  };\n\n  // remove an image\n  const shiftImage = ({ root }) => {\n    const imageView = root.ref.images.shift();\n    imageView.opacity = 0;\n    imageView.translateY = -15;\n    root.ref.imageViewBin.push(imageView);\n    return imageView;\n  };\n\n  // add new image\n  const pushImage = ({ root, props, image }) => {\n    const id = props.id;\n    const item = root.query('GET_ITEM', { id });\n    if (!item) return;\n\n    const crop = item.getMetadata('crop') || {\n      center: {\n        x: 0.5,\n        y: 0.5\n      },\n      flip: {\n        horizontal: false,\n        vertical: false\n      },\n      zoom: 1,\n      rotation: 0,\n      aspectRatio: null\n    };\n\n    const background = root.query(\n      'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n    );\n\n    let markup;\n    let resize;\n    let dirty = false;\n    if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n      markup = item.getMetadata('markup') || [];\n      resize = item.getMetadata('resize');\n      dirty = true;\n    }\n\n    // append image presenter\n    const imageView = root.appendChildView(\n      root.createChildView(ImageView, {\n        id,\n        image,\n        crop,\n        resize,\n        markup,\n        dirty,\n        background,\n        opacity: 0,\n        scaleX: 1.15,\n        scaleY: 1.15,\n        translateY: 15\n      }),\n      root.childViews.length\n    );\n    root.ref.images.push(imageView);\n\n    // reveal the preview image\n    imageView.opacity = 1;\n    imageView.scaleX = 1;\n    imageView.scaleY = 1;\n    imageView.translateY = 0;\n\n    // the preview is now ready to be drawn\n    setTimeout(() => {\n      root.dispatch('DID_IMAGE_PREVIEW_SHOW', { id });\n    }, 250);\n  };\n\n  const updateImage = ({ root, props }) => {\n    const item = root.query('GET_ITEM', { id: props.id });\n    if (!item) return;\n    const imageView = root.ref.images[root.ref.images.length - 1];\n    imageView.crop = item.getMetadata('crop');\n    imageView.background = root.query(\n      'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n    );\n    if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n      imageView.dirty = true;\n      imageView.resize = item.getMetadata('resize');\n      imageView.markup = item.getMetadata('markup');\n    }\n  };\n\n  // replace image preview\n  const didUpdateItemMetadata = ({ root, props, action }) => {\n    // only filter and crop trigger redraw\n    if (!/crop|filter|markup|resize/.test(action.change.key)) return;\n\n    // no images to update, exit\n    if (!root.ref.images.length) return;\n\n    // no item found, exit\n    const item = root.query('GET_ITEM', { id: props.id });\n    if (!item) return;\n\n    // for now, update existing image when filtering\n    if (/filter/.test(action.change.key)) {\n      const imageView = root.ref.images[root.ref.images.length - 1];\n      applyFilter(root, action.change.value, imageView.image);\n      return;\n    }\n\n    if (/crop|markup|resize/.test(action.change.key)) {\n      const crop = item.getMetadata('crop');\n      const image = root.ref.images[root.ref.images.length - 1];\n\n      // if aspect ratio has changed, we need to create a new image\n      if (\n        crop &&\n        crop.aspectRatio &&\n        image.crop &&\n        image.crop.aspectRatio &&\n        Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 0.00001\n      ) {\n        const imageView = shiftImage({ root });\n        pushImage({ root, props, image: cloneCanvas(imageView.image) });\n      }\n      // if not, we can update the current image\n      else {\n        updateImage({ root, props });\n      }\n    }\n  };\n\n  const canCreateImageBitmap = file => {\n    // Firefox versions before 58 will freeze when running createImageBitmap\n    // in a Web Worker so we detect those versions and return false for support\n    const userAgent = window.navigator.userAgent;\n    const isFirefox = userAgent.match(/Firefox\\/([0-9]+)\\./);\n    const firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;\n    if (firefoxVersion !== null && firefoxVersion <= 58) return false;\n\n    return 'createImageBitmap' in window && isBitmap(file);\n  };\n\n  /**\n   * Write handler for when preview container has been created\n   */\n  const didCreatePreviewContainer = ({ root, props }) => {\n    const { id } = props;\n\n    // we need to get the file data to determine the eventual image size\n    const item = root.query('GET_ITEM', id);\n    if (!item) return;\n\n    // get url to file (we'll revoke it later on when done)\n    const fileURL = URL.createObjectURL(item.file);\n\n    // determine image size of this item\n    getImageSize(fileURL, (width, height) => {\n      // we can now scale the panel to the final size\n      root.dispatch('DID_IMAGE_PREVIEW_CALCULATE_SIZE', {\n        id,\n        width,\n        height\n      });\n    });\n  };\n\n  const drawPreview = ({ root, props }) => {\n    const { id } = props;\n\n    // we need to get the file data to determine the eventual image size\n    const item = root.query('GET_ITEM', id);\n    if (!item) return;\n\n    // get url to file (we'll revoke it later on when done)\n    const fileURL = URL.createObjectURL(item.file);\n\n    // fallback\n    const loadPreviewFallback = () => {\n      // let's scale the image in the main thread :(\n      loadImage(fileURL).then(previewImageLoaded);\n    };\n\n    // image is now ready\n    const previewImageLoaded = imageData => {\n      // the file url is no longer needed\n      URL.revokeObjectURL(fileURL);\n\n      // draw the scaled down version here and use that as source so bitmapdata can be closed\n      // orientation info\n      const exif = item.getMetadata('exif') || {};\n      const orientation = exif.orientation || -1;\n\n      // get width and height from action, and swap if orientation is incorrect\n      let { width, height } = imageData;\n\n      // if no width or height, just return early.\n      if (!width || !height) return;\n\n      if (orientation >= 5 && orientation <= 8) {\n        [width, height] = [height, width];\n      }\n\n      // scale canvas based on pixel density\n      // we multiply by .75 as that creates smaller but still clear images on screens with high res displays\n      const pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75);\n\n      // we want as much pixels to work with as possible,\n      // this multiplies the minimum image resolution,\n      // so when zooming in it doesn't get too blurry\n      const zoomFactor = root.query('GET_IMAGE_PREVIEW_ZOOM_FACTOR');\n\n      // imaeg scale factor\n      const scaleFactor = zoomFactor * pixelDensityFactor;\n\n      // calculate scaled preview image size\n      const previewImageRatio = height / width;\n\n      // calculate image preview height and width\n      const previewContainerWidth = root.rect.element.width;\n      const previewContainerHeight = root.rect.element.height;\n\n      let imageWidth = previewContainerWidth;\n      let imageHeight = imageWidth * previewImageRatio;\n\n      if (previewImageRatio > 1) {\n        imageWidth = Math.min(width, previewContainerWidth * scaleFactor);\n        imageHeight = imageWidth * previewImageRatio;\n      } else {\n        imageHeight = Math.min(height, previewContainerHeight * scaleFactor);\n        imageWidth = imageHeight / previewImageRatio;\n      }\n\n      // transfer to image tag so no canvas memory wasted on iOS\n      const previewImage = createPreviewImage(\n        imageData,\n        imageWidth,\n        imageHeight,\n        orientation\n      );\n\n      // done\n      const done = () => {\n        // calculate average image color, disabled for now\n        const averageColor = root.query(\n          'GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR'\n        )\n          ? calculateAverageColor(data)\n          : null;\n        item.setMetadata('color', averageColor, true);\n\n        // data has been transferred to canvas ( if was ImageBitmap )\n        if ('close' in imageData) {\n          imageData.close();\n        }\n\n        // show the overlay\n        root.ref.overlayShadow.opacity = 1;\n\n        // create the first image\n        pushImage({ root, props, image: previewImage });\n      };\n\n      // apply filter\n      const filter = item.getMetadata('filter');\n      if (filter) {\n        applyFilter(root, filter, previewImage).then(done);\n      } else {\n        done();\n      }\n    };\n\n    // if we support scaling using createImageBitmap we use a worker\n    if (canCreateImageBitmap(item.file)) {\n      // let's scale the image in a worker\n      const worker = createWorker(BitmapWorker);\n\n      worker.post(\n        {\n          file: item.file\n        },\n        imageBitmap => {\n          // destroy worker\n          worker.terminate();\n\n          // no bitmap returned, must be something wrong,\n          // try the oldschool way\n          if (!imageBitmap) {\n            loadPreviewFallback();\n            return;\n          }\n\n          // yay we got our bitmap, let's continue showing the preview\n          previewImageLoaded(imageBitmap);\n        }\n      );\n    } else {\n      // create fallback preview\n      loadPreviewFallback();\n    }\n  };\n\n  /**\n   * Write handler for when the preview image is ready to be animated\n   */\n  const didDrawPreview = ({ root }) => {\n    // get last added image\n    const image = root.ref.images[root.ref.images.length - 1];\n    image.translateY = 0;\n    image.scaleX = 1.0;\n    image.scaleY = 1.0;\n    image.opacity = 1;\n  };\n\n  /**\n   * Write handler for when the preview has been loaded\n   */\n  const restoreOverlay = ({ root }) => {\n    root.ref.overlayShadow.opacity = 1;\n    root.ref.overlayError.opacity = 0;\n    root.ref.overlaySuccess.opacity = 0;\n  };\n\n  const didThrowError = ({ root }) => {\n    root.ref.overlayShadow.opacity = 0.25;\n    root.ref.overlayError.opacity = 1;\n  };\n\n  const didCompleteProcessing = ({ root }) => {\n    root.ref.overlayShadow.opacity = 0.25;\n    root.ref.overlaySuccess.opacity = 1;\n  };\n\n  /**\n   * Constructor\n   */\n  const create = ({ root }) => {\n    // image view\n    root.ref.images = [];\n\n    // the preview image data (we need this to filter the image)\n    root.ref.imageData = null;\n\n    // image bin\n    root.ref.imageViewBin = [];\n\n    // image overlays\n    root.ref.overlayShadow = root.appendChildView(\n      root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'idle'\n      })\n    );\n\n    root.ref.overlaySuccess = root.appendChildView(\n      root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'success'\n      })\n    );\n\n    root.ref.overlayError = root.appendChildView(\n      root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'failure'\n      })\n    );\n  };\n\n  return _.utils.createView({\n    name: 'image-preview-wrapper',\n    create,\n    styles: ['height'],\n    apis: ['height'],\n    destroy: ({ root }) => {\n      // we resize the image so memory on iOS 12 is released more quickly (it seems)\n      root.ref.images.forEach(imageView => {\n        imageView.image.width = 1;\n        imageView.image.height = 1;\n      });\n    },\n    didWriteView: ({ root }) => {\n      root.ref.images.forEach(imageView => {\n        imageView.dirty = false;\n      });\n    },\n    write: _.utils.createRoute(\n      {\n        // image preview stated\n        DID_IMAGE_PREVIEW_DRAW: didDrawPreview,\n        DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n        DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,\n        DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,\n\n        // file states\n        DID_THROW_ITEM_LOAD_ERROR: didThrowError,\n        DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,\n        DID_THROW_ITEM_INVALID: didThrowError,\n        DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,\n        DID_START_ITEM_PROCESSING: restoreOverlay,\n        DID_REVERT_ITEM_PROCESSING: restoreOverlay\n      },\n      ({ root }) => {\n        // views on death row\n        const viewsToRemove = root.ref.imageViewBin.filter(\n          imageView => imageView.opacity === 0\n        );\n\n        // views to retain\n        root.ref.imageViewBin = root.ref.imageViewBin.filter(\n          imageView => imageView.opacity > 0\n        );\n\n        // remove these views\n        viewsToRemove.forEach(imageView => removeImageView(root, imageView));\n        viewsToRemove.length = 0;\n      }\n    )\n  });\n};\n\n/**\n * Image Preview Plugin\n */\nconst plugin = fpAPI => {\n  const { addFilter, utils } = fpAPI;\n  const { Type, createRoute, isFile } = utils;\n\n  // imagePreviewView\n  const imagePreviewView = createImageWrapperView(fpAPI);\n\n  // called for each view that is created right after the 'create' method\n  addFilter('CREATE_VIEW', viewAPI => {\n    // get reference to created view\n    const { is, view, query } = viewAPI;\n\n    // only hook up to item view and only if is enabled for this cropper\n    if (!is('file') || !query('GET_ALLOW_IMAGE_PREVIEW')) return;\n\n    // create the image preview plugin, but only do so if the item is an image\n    const didLoadItem = ({ root, props }) => {\n      const { id } = props;\n      const item = query('GET_ITEM', id);\n\n      // item could theoretically have been removed in the mean time\n      if (!item || !isFile(item.file) || item.archived) return;\n\n      // get the file object\n      const file = item.file;\n\n      // exit if this is not an image\n      if (!isPreviewableImage(file)) return;\n\n      // test if is filtered\n      if (!query('GET_IMAGE_PREVIEW_FILTER_ITEM')(item)) return;\n\n      // exit if image size is too high and no createImageBitmap support\n      // this would simply bring the browser to its knees and that is not what we want\n      const supportsCreateImageBitmap = 'createImageBitmap' in (window || {});\n      const maxPreviewFileSize = query('GET_IMAGE_PREVIEW_MAX_FILE_SIZE');\n      if (\n        !supportsCreateImageBitmap &&\n        (maxPreviewFileSize && file.size > maxPreviewFileSize)\n      )\n        return;\n\n      // set preview view\n      root.ref.imagePreview = view.appendChildView(\n        view.createChildView(imagePreviewView, { id })\n      );\n\n      // update height if is fixed\n      const fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n      if (fixedPreviewHeight) {\n        root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n          id: item.id,\n          height: fixedPreviewHeight\n        });\n      }\n\n      // now ready\n      const queue =\n        !supportsCreateImageBitmap &&\n        file.size > query('GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE');\n      root.dispatch('DID_IMAGE_PREVIEW_CONTAINER_CREATE', { id }, queue);\n    };\n\n    const rescaleItem = (root, props) => {\n      if (!root.ref.imagePreview) return;\n\n      let { id } = props;\n\n      // get item\n      const item = root.query('GET_ITEM', { id });\n      if (!item) return;\n\n      // if is fixed height or panel has aspect ratio, exit here, height has already been defined\n      const panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n      const itemPanelAspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO');\n      const fixedHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n      if (panelAspectRatio || itemPanelAspectRatio || fixedHeight) return;\n\n      // no data!\n      let { imageWidth, imageHeight } = root.ref;\n      if (!imageWidth || !imageHeight) return;\n\n      // get height min and max\n      const minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n      const maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n      // orientation info\n      const exif = item.getMetadata('exif') || {};\n      const orientation = exif.orientation || -1;\n\n      // get width and height from action, and swap of orientation is incorrect\n      if (orientation >= 5 && orientation <= 8)\n        [imageWidth, imageHeight] = [imageHeight, imageWidth];\n\n      // scale up width and height when we're dealing with an SVG\n      if (!isBitmap(item.file) || root.query('GET_IMAGE_PREVIEW_UPSCALE')) {\n        const scalar = 2048 / imageWidth;\n        imageWidth *= scalar;\n        imageHeight *= scalar;\n      }\n\n      // image aspect ratio\n      const imageAspectRatio = imageHeight / imageWidth;\n\n      // we need the item to get to the crop size\n      const previewAspectRatio =\n        (item.getMetadata('crop') || {}).aspectRatio || imageAspectRatio;\n\n      // preview height range\n      let previewHeightMax = Math.max(\n        minPreviewHeight,\n        Math.min(imageHeight, maxPreviewHeight)\n      );\n      const itemWidth = root.rect.element.width;\n      const previewHeight = Math.min(\n        itemWidth * previewAspectRatio,\n        previewHeightMax\n      );\n\n      // request update to panel height\n      root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n        id: item.id,\n        height: previewHeight\n      });\n    };\n\n    const didResizeView = ({ root }) => {\n      // actions in next write operation\n      root.ref.shouldRescale = true;\n    };\n\n    const didUpdateItemMetadata = ({ root, action }) => {\n      if (action.change.key !== 'crop') return;\n\n      // actions in next write operation\n      root.ref.shouldRescale = true;\n    };\n\n    const didCalculatePreviewSize = ({ root, action }) => {\n      // remember dimensions\n      root.ref.imageWidth = action.width;\n      root.ref.imageHeight = action.height;\n\n      // actions in next write operation\n      root.ref.shouldRescale = true;\n      root.ref.shouldDrawPreview = true;\n\n      // as image load could take a while and fire when draw loop is resting we need to give it a kick\n      root.dispatch('KICK');\n    };\n\n    // start writing\n    view.registerWriter(\n      createRoute(\n        {\n          DID_RESIZE_ROOT: didResizeView,\n          DID_STOP_RESIZE: didResizeView,\n          DID_LOAD_ITEM: didLoadItem,\n          DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,\n          DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata\n        },\n        ({ root, props }) => {\n          // no preview view attached\n          if (!root.ref.imagePreview) return;\n\n          // don't do anything while hidden\n          if (root.rect.element.hidden) return;\n\n          // resize the item panel\n          if (root.ref.shouldRescale) {\n            rescaleItem(root, props);\n            root.ref.shouldRescale = false;\n          }\n\n          if (root.ref.shouldDrawPreview) {\n            // queue till next frame so we're sure the height has been applied this forces the draw image call inside the wrapper view to use the correct height\n            requestAnimationFrame(() => {\n              // this requestAnimationFrame nesting is horrible but it fixes an issue with 100hz displays on Chrome\n              // https://github.com/pqina/filepond-plugin-image-preview/issues/57\n              requestAnimationFrame(() => {\n                root.dispatch('DID_FINISH_CALCULATE_PREVIEWSIZE', {\n                  id: props.id\n                });\n              });\n            });\n\n            root.ref.shouldDrawPreview = false;\n          }\n        }\n      )\n    );\n  });\n\n  // expose plugin\n  return {\n    options: {\n      // Enable or disable image preview\n      allowImagePreview: [true, Type.BOOLEAN],\n\n      // filters file items to determine which are shown as preview\n      imagePreviewFilterItem: [() => true, Type.FUNCTION],\n\n      // Fixed preview height\n      imagePreviewHeight: [null, Type.INT],\n\n      // Min image height\n      imagePreviewMinHeight: [44, Type.INT],\n\n      // Max image height\n      imagePreviewMaxHeight: [256, Type.INT],\n\n      // Max size of preview file for when createImageBitmap is not supported\n      imagePreviewMaxFileSize: [null, Type.INT],\n\n      // The amount of extra pixels added to the image preview to allow comfortable zooming\n      imagePreviewZoomFactor: [2, Type.INT],\n\n      // Should we upscale small images to fit the max bounding box of the preview area\n      imagePreviewUpscale: [false, Type.BOOLEAN],\n\n      // Max size of preview file that we allow to try to instant preview if createImageBitmap is not supported, else image is queued for loading\n      imagePreviewMaxInstantPreviewFileSize: [1000000, Type.INT],\n\n      // Style of the transparancy indicator used behind images\n      imagePreviewTransparencyIndicator: [null, Type.STRING],\n\n      // Enables or disables reading average image color\n      imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],\n\n      // Enables or disables the previewing of markup\n      imagePreviewMarkupShow: [true, Type.BOOLEAN],\n\n      // Allows filtering of markup to only show certain shapes\n      imagePreviewMarkupFilter: [() => true, Type.FUNCTION]\n    }\n  };\n};\n\n// fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\nconst isBrowser =\n  typeof window !== 'undefined' && typeof window.document !== 'undefined';\nif (isBrowser) {\n  document.dispatchEvent(\n    new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n  );\n}\n\nexport default plugin;\n"],"names":[],"mappings":"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","ignoreList":[0,1]}